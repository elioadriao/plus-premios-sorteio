{% extends "layout/navigation.html" %}

{% load static %}

{% block title %}Detalhes do Sorteio{% endblock %}

{% block content %}

<!--? About Area Start -->
<div class="about-low-area padding-bottom">
  <div class="container">
    <div class="row">
      <div class="col-lg-6 col-md-12">
        <div class="about-caption mb-50">
          <!-- Section Tittle -->
          <div class="section-tittle mb-35">
            <h2>Detalhes do Sorteio</h2>
            <h3>Data: {{ raffle.date|date:"d/m/Y H:i" }}</h3>
          </div>
          <p>Titulo: {{ raffle.title }}</p>
          <p>Descrição: {{ raffle.description }}</p>
          {% if raffle.get_winner is not None %}
          <p>Vencedor: {{ raffle.get_winner }}</p>
          {% endif %}
        </div>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="about-img">
          <div class="img-fluid">
            <img style="max-height: 350px;" src="{% static 'vendor/img/phone.png' %}" alt="">
          </div>
        </div>
      </div>
      <div class="col-lg-12 col-md-12">
        {% for quota in raffle.quota_set.all %}
        <a href="#" class="genric-btn {{ quota.get_btn }} small radius open-modal" data-toggle="modal" data-target="#quotaModal" data-number={{ quota.number }} data-status={{ quota.status }}>
          Cota: {{ quota.number }} | {{ quota.get_status }}
        </a>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
<!-- About Area End -->
<div class="modal fade modal-filter" id="quotaModal" tabindex="-1" role="dialog" aria-labelledby="quotaModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title title-a" id="quotaModalLabel">Reservar Cota</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form class="modal-form" method="post">
          {% csrf_token %}
          {{ form.as_p }}
          <button id="btn_submit" class="btn radius" type="submit">Reservar</button>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}
{% block post_js %}
<script>
  $(document).on("click", ".open-modal", function () {
    var quotaNumber = $(this).data("number");
    var quotaStatus = $(this).data("status");
    $("#id_number").val( quotaNumber );
    console.log(quotaStatus);
    if (quotaStatus == "paid") {
      $("#btn_submit").prop("hidden", true);
    }else{
      $("#btn_submit").prop("hidden", false);
    }
    if (quotaStatus == "open") {
      $("#btn_submit").text("Reservar");
    }else{
      $("#btn_submit").text("Confirmar Pagamento");
    }
  });
</script>
{% endblock %}